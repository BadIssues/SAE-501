!
! EDGE1 - Configuration complete (N=4)
! SAE501 - WorldSkills Lyon 2025
!
version 15.5
service timestamps debug datetime msec
service timestamps log datetime msec
service password-encryption
!
hostname EDGE1
!
boot-start-marker
boot-end-marker
!
enable secret 5 $1$mERr$hx5rVt7rPNoS4wqbXKX7m0
!
username admin privilege 15 secret 5 $1$mERr$hx5rVt7rPNoS4wqbXKX7m0
!
no aaa new-model
!
ip domain-name wsl2025.org
no ip domain-lookup
ip cef
no ipv6 cef
!
crypto key generate rsa modulus 2048
!
ip ssh version 2
ip ssh time-out 120
ip ssh authentication-retries 3
!
multilink bundle-name authenticated
!
track 10 interface GigabitEthernet0/1.100 line-protocol
!
interface Loopback0
 description Provider-Independent-IP
 ip address 191.4.157.33 255.255.255.240
!
interface GigabitEthernet0/0
 description TO-WANRTR-Gi0/0
 no ip address
!
interface GigabitEthernet0/0.13
 description LINK-TO-WANRTR (VRF MAN)
 encapsulation dot1Q 13
 ip address 10.4.254.13 255.255.255.252
 ip ospf authentication message-digest
 ip ospf message-digest-key 1 md5 P@ssw0rd
 ip ospf network point-to-point
!
interface GigabitEthernet0/0.14
 description LINK-TO-WANRTR (VRF INET)
 encapsulation dot1Q 14
 ip address 91.4.222.97 255.255.255.248
 ip nat outside
!
interface GigabitEthernet0/1
 description TO-CORESW1-Fe1/0/1
 no ip address
!
interface GigabitEthernet0/1.100
 description LINK-TO-CORESW1 (VLAN100)
 encapsulation dot1Q 100
 ip address 10.4.254.1 255.255.255.252
 ip nat inside
!
interface GigabitEthernet0/1.300
 description LINK-TO-EDGE2 via VLAN300
 encapsulation dot1Q 300
 ip address 10.4.254.9 255.255.255.252
 ip nat inside
 ip ospf authentication message-digest
 ip ospf message-digest-key 1 md5 P@ssw0rd
!
interface GigabitEthernet0/1.30
 description DMZ-VLAN30
 encapsulation dot1Q 30
 ip address 217.4.160.253 255.255.255.0
 standby 30 ip 217.4.160.254
 standby 30 priority 110
 standby 30 preempt
 standby 30 track 10 decrement 20
 ip nat inside
!
interface GigabitEthernet0/2
 description UNUSED
 no ip address
 shutdown
!
interface GigabitEthernet0/3
 description UNUSED
 no ip address
 shutdown
!
router ospf 1
 router-id 10.4.254.13
 area 4 nssa no-summary
 passive-interface default
 no passive-interface GigabitEthernet0/0.13
 no passive-interface GigabitEthernet0/1.300
 network 10.4.254.12 0.0.0.3 area 4
 network 10.4.254.8 0.0.0.3 area 4
 network 10.4.254.0 0.0.0.3 area 4
 network 91.4.222.96 0.0.0.7 area 4
 redistribute static subnets
!
router bgp 65416
 bgp router-id 10.4.254.13
 bgp log-neighbor-changes
 neighbor 10.4.254.10 remote-as 65416
 neighbor 10.4.254.10 description iBGP-TO-EDGE2
 neighbor 10.4.254.10 update-source GigabitEthernet0/1.300
 neighbor 91.4.222.98 remote-as 65430
 neighbor 91.4.222.98 description eBGP-TO-WANRTR
 !
 address-family ipv4
  network 191.4.157.32 mask 255.255.255.240
  network 217.4.160.0 mask 255.255.255.0
  neighbor 10.4.254.10 activate
  neighbor 10.4.254.10 next-hop-self
  neighbor 91.4.222.98 activate
  neighbor 91.4.222.98 route-map SET-LOCAL-PREF in
 exit-address-family
!
ip forward-protocol nd
!
no ip http server
no ip http secure-server
!
ip nat inside source list NAT-ACL interface GigabitEthernet0/0.14 overload
ip nat inside source static tcp 10.4.10.2 443 191.4.157.33 4443 extendable
ip nat inside source static tcp 10.4.10.3 80 191.4.157.33 80 extendable
ip nat inside source static tcp 10.4.10.3 443 191.4.157.33 443 extendable
!
ip access-list extended NAT-ACL
 permit ip 10.4.0.0 0.0.255.255 any
!
ip access-list extended SSH-ACCESS
 permit tcp 10.4.99.0 0.0.0.255 any eq 22
 deny   tcp any any eq 22 log
 permit ip any any
!
ip route 10.4.0.0 255.255.0.0 10.4.254.2
ip route 191.4.157.32 255.255.255.240 Null0
ip route 217.4.160.0 255.255.255.0 Null0
!
route-map SET-LOCAL-PREF permit 10
 set local-preference 200
!
banner login ^C
/!\ Restricted access. Only for authorized people /!\
^C
!
line con 0
 logging synchronous
line aux 0
line vty 0 4
 access-class SSH-ACCESS in
 exec-timeout 5 0
 absolute-timeout 20
 login local
 transport input ssh
!
end
